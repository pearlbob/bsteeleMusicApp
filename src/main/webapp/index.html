<!doctype html>

<html>
    <head>
        <meta charset="UTF-8">
        <meta http-equiv="content-type" content="text/html; charset=UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="shortcut icon" href="images/runningsmall.ico" />

        <title>bsteele music</title>
        <meta name="description" content="bsteele.com Music App selection page">
        <meta name="keywords" content="bass,guitar,sheet music,audio">
        <meta name="author" content="Robert Steele, bsteele.com">

        <!-- If you add any GWT meta tags, they must   -->
        <!-- be added before this line.                -->
        <script type="text/javascript" src="bsteelemusicapp/bsteelemusicapp.nocache.js"></script>

        <link type="text/css" rel="stylesheet" href="./css/bsteeleMusicApp.css" />
<!--
    todo: 

    screen control screen
    logging screen
    
-->
        <script>
            'use strict';
            
            //  fix loading issues
            let  isModuleLoad = false;
            let  isLoad = false;

            let bpmTally;

            let bpmTap;

            function onNativeTap(event) {

                let t = event.timeStamp / 1000; //  in units of seconds
                //window.console.log("tap timestamp: " + t);
                bpmTap.tap(t);
            }

            function log(arg) {
                window.console.log(arg);
            }

            function animationFrameUpdate()
            {
                function update() {

                    bpmTally.innerHTML = bpmTap.getBPM();

                    window.requestAnimationFrame(update);
                }
                update();
            }

            function onLoad() {
                //log("onLoad()");
                bpmTally = document.getElementById("bpmTally");

                isLoad = true;
                lastOfLoad();
            }

            function onModuleLoadJS() {
                //   populate java objects
                bpmTap = new com.bsteele.bsteeleMusicApp.client.BpmTap();

                isModuleLoad = true;
                lastOfLoad();
            }

            function lastOfLoad() {
                if (isModuleLoad && isLoad)
                {
                    //  finish page initization now that we're all here
                    animationFrameUpdate();
                }
            }
        </script>
    </head>

    <body onload="onLoad();">

        <!-- RECOMMENDED if your web app will not function without JavaScript enabled -->
        <noscript>
        <div>
            Your web browser must have JavaScript enabled
            in order for this application to display correctly.
        </div>
        </noscript>

        <h1>bsteele Music App</h1>

        <table>
            <tr>
                <td><a href="./lyrics.html">Lyrics</a> </td>        
            </tr>
            <tr>
                <td><a href="./bassStudyTool.html">Bob's Bass Study Tool</a></td>        
            </tr>
        </table>
        <p></p>
        <table>
            <tr>
                <td><button type="button" onclick="onNativeTap(event);" >Tap for BPM</button></td>
                <td id="bpmTally">106</td>
            </tr>
            <tr>
                <td colspan="2" style="color:red;" id="errorLabelContainer"></td>
            </tr>
        </table>

    </body>
</html>
