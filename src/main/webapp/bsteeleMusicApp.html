<!doctype html>
<!-- The DOCTYPE declaration above will set the     -->
<!-- browser's rendering engine into                -->
<!-- "Standards Mode". Replacing this declaration   -->
<!-- with a "Quirks Mode" doctype is not supported. -->

<html>
    <head>
        <link rel="shortcut icon" href="images/runningsmall.ico" />
        
        <meta http-equiv="content-type" content="text/html; charset=UTF-8">

        <!--                                                               -->
        <!-- Consider inlining CSS to reduce the number of requested files -->
        <link type="text/css" rel="stylesheet" href="bsteeleMusicApp.css">

        <title>bsteele music</title>

        <!--                                           -->
        <!-- This script loads your compiled module.   -->
        <!-- If you add any GWT meta tags, they must   -->
        <!-- be added before this line.                -->
        <!--                                           -->
        <script type="text/javascript" src="bsteelemusicapp/bsteelemusicapp.nocache.js"></script>

        <script>
            let bpmTap;

            function onNativeTap(event) {

                let t = event.timeStamp / 1000; //  in units of seconds
                //window.console.log("tap timestamp: " + t);
                if (bpmTap === undefined)
                    bpmTap = new com.bsteele.bsteeleMusicApp.client.BpmTap();
                bpmTap.tap(t);
            }

            function log(arg) {
                window.console.log(arg);
            }

            function animationFrameUpdate()
            {
                function update() {

                    if (bpmTap !== undefined)
                        bpmTally.innerHTML = bpmTap.getBPM();

                    window.requestAnimationFrame(update);
                }
                update();
            }

            function onLoad() {
                log( "onLoad()");
                bpmTally = inputFile = document.getElementById("bpmTally");

                animationFrameUpdate();
            }
        </script>
    </head>

    <!--                                           -->
    <!-- The body can have arbitrary html, or      -->
    <!-- you can leave the body empty if you want  -->
    <!-- to create a completely dynamic UI.        -->
    <!--                                           -->
    <body onload="onLoad();">

        <!-- RECOMMENDED if your web app will not function without JavaScript enabled -->
        <noscript>
        <div style="width: 22em; position: absolute; left: 50%; margin-left: -11em; color: red; background-color: white; border: 1px solid red; padding: 4px; font-family: sans-serif">
            Your web browser must have JavaScript enabled
            in order for this application to display correctly.
        </div>
        </noscript>

        <h1>bsteele Music App</h1>

        <table>
            <tr>
                <td colspan="2" style="font-weight:bold;">Please enter your name:</td>        
            </tr>
            <tr>
                <td id="nameFieldContainer"></td>
                <td id="sendButtonContainer"></td>
            </tr>
            <tr>
                <td><button type="button" onclick="onNativeTap(event);" >Tap for BPM</button></td>
                <td id="bpmTally">106</td>
            </tr>
            <tr>
                <td colspan="2" style="color:red;" id="errorLabelContainer"></td>
            </tr>
        </table>

    </body>
</html>
